<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CVE-2023-30253 on</title><link>https://h4r1337.github.io/tags/cve-2023-30253/</link><description>Recent content in CVE-2023-30253 on</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sat, 28 Sep 2024 22:01:42 +0530</lastBuildDate><atom:link href="https://h4r1337.github.io/tags/cve-2023-30253/index.xml" rel="self" type="application/rss+xml"/><item><title>BoardLight | HackTheBox</title><link>https://h4r1337.github.io/posts/board-light/</link><pubDate>Sat, 28 Sep 2024 22:01:42 +0530</pubDate><guid>https://h4r1337.github.io/posts/board-light/</guid><description>&lt;h3 id="overview">Overview&lt;/h3>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/cover.webp">&lt;/figure>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">Title&lt;/th>
&lt;th style="text-align: center">&lt;a href="https://app.hackthebox.com/machines/BoardLight">BoardLight&lt;/a>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">Difficulty&lt;/td>
&lt;td style="text-align: center">Easy&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">Machine&lt;/td>
&lt;td style="text-align: center">Linux&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">Maker&lt;/td>
&lt;td style="text-align: center">&lt;a href="https://app.hackthebox.com/users/116842">&lt;img src="https://www.hackthebox.com/badge/image/116842" alt="" style="display: unset">&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;br>
&lt;div class="alert alert-tip collapsed">
&lt;div class="alert-heading-box" onclick="toggleAlert(this)" >
&lt;i class="bx bx-bulb">&lt;/i>
&lt;p class="alert-heading">
About BoardLight
&lt;/p>
&lt;i class='bx bx-chevron-down collapsed'>&lt;/i>
&lt;/div>
&lt;div class="alert-content" style="display: none;" >
&lt;p>BoardLight is an easy difficulty Linux machine that features a &lt;code>Dolibarr&lt;/code> instance vulnerable to &lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2023-30253">CVE-2023-30253&lt;/a>. This vulnerability is leveraged to gain access as &lt;code>www-data&lt;/code>. After enumerating and dumping the web configuration file contents, plaintext credentials lead to &lt;code>SSH&lt;/code> access to the machine. Enumerating the system, a &lt;code>SUID&lt;/code> binary related to &lt;code>enlightenment&lt;/code> is identified which is vulnerable to privilege escalation via &lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2022-37706">CVE-2022-37706&lt;/a> and can be abused to leverage a root shell.&lt;/p></description><content>&lt;h3 id="overview">Overview&lt;/h3>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/cover.webp">&lt;/figure>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">Title&lt;/th>
&lt;th style="text-align: center">&lt;a href="https://app.hackthebox.com/machines/BoardLight">BoardLight&lt;/a>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">Difficulty&lt;/td>
&lt;td style="text-align: center">Easy&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">Machine&lt;/td>
&lt;td style="text-align: center">Linux&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">Maker&lt;/td>
&lt;td style="text-align: center">&lt;a href="https://app.hackthebox.com/users/116842">&lt;img src="https://www.hackthebox.com/badge/image/116842" alt="" style="display: unset">&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;br>
&lt;div class="alert alert-tip collapsed">
&lt;div class="alert-heading-box" onclick="toggleAlert(this)" >
&lt;i class="bx bx-bulb">&lt;/i>
&lt;p class="alert-heading">
About BoardLight
&lt;/p>
&lt;i class='bx bx-chevron-down collapsed'>&lt;/i>
&lt;/div>
&lt;div class="alert-content" style="display: none;" >
&lt;p>BoardLight is an easy difficulty Linux machine that features a &lt;code>Dolibarr&lt;/code> instance vulnerable to &lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2023-30253">CVE-2023-30253&lt;/a>. This vulnerability is leveraged to gain access as &lt;code>www-data&lt;/code>. After enumerating and dumping the web configuration file contents, plaintext credentials lead to &lt;code>SSH&lt;/code> access to the machine. Enumerating the system, a &lt;code>SUID&lt;/code> binary related to &lt;code>enlightenment&lt;/code> is identified which is vulnerable to privilege escalation via &lt;a href="https://nvd.nist.gov/vuln/detail/CVE-2022-37706">CVE-2022-37706&lt;/a> and can be abused to leverage a root shell.&lt;/p>
&lt;/div>
&lt;/div>
&lt;script>
function toggleAlert(headerElement) {
var alertBox = headerElement.parentElement;
var alertContent = alertBox.querySelector('.alert-content');
var icon = headerElement.querySelectorAll('i')[1];
alertBox.classList.toggle('open');
alertBox.classList.toggle('collapsed');
if (alertBox.classList.contains('open')) {
alertContent.style.display = 'block';
icon.classList.remove('open');
icon.classList.add('collapsed');
} else {
icon.classList.remove('collapsed');
icon.classList.add('open');
alertContent.style.display = 'none';
}
}
&lt;/script>
&lt;h2 id="information-gathering">Information Gathering&lt;/h2>
&lt;p>Scanned all TCP ports:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>nmap -p- -vv -Pn -T4 --min-rate &lt;span style="color:#d3869b">1000&lt;/span> -oA nmap/ports 10.10.11.11
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Nmap scan report &lt;span style="color:#fe8019">for&lt;/span> 10.10.11.11
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host is up, received user-set &lt;span style="color:#fe8019">(&lt;/span>0.15s latency&lt;span style="color:#fe8019">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Scanned at 2024-05-28 11:16:43 IST &lt;span style="color:#fe8019">for&lt;/span> 82s
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Not shown: &lt;span style="color:#d3869b">65107&lt;/span> closed ports, &lt;span style="color:#d3869b">426&lt;/span> filtered ports
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Reason: &lt;span style="color:#d3869b">65107&lt;/span> conn-refused and &lt;span style="color:#d3869b">426&lt;/span> no-responses
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE REASON
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh syn-ack
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http syn-ack
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Enumerated open TCP ports:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>nmap -p22,80 -sC -sV -vv -Pn -T4 --min-rate &lt;span style="color:#d3869b">1000&lt;/span> -oA nmap/services 10.10.11.11
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Nmap scan report &lt;span style="color:#fe8019">for&lt;/span> board.htb &lt;span style="color:#fe8019">(&lt;/span>10.10.11.11&lt;span style="color:#fe8019">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Host is up, received user-set &lt;span style="color:#fe8019">(&lt;/span>0.27s latency&lt;span style="color:#fe8019">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Scanned at 2024-05-28 11:23:23 IST &lt;span style="color:#fe8019">for&lt;/span> 14s
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>PORT STATE SERVICE REASON VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 &lt;span style="color:#fe8019">(&lt;/span>Ubuntu Linux; protocol 2.0&lt;span style="color:#fe8019">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>80/tcp open http syn-ack Apache httpd 2.4.41 &lt;span style="color:#fe8019">((&lt;/span>Ubuntu&lt;span style="color:#fe8019">))&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| http-methods:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_ Supported Methods: GET HEAD POST OPTIONS
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-server-header: Apache/2.4.41 &lt;span style="color:#fe8019">(&lt;/span>Ubuntu&lt;span style="color:#fe8019">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>|_http-title: Site doesn&amp;#39;t have a title &lt;span style="color:#fe8019">(&lt;/span>text/html; charset&lt;span style="color:#fe8019">=&lt;/span>UTF-8&lt;span style="color:#fe8019">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="port-80---http-apache-2441">Port 80 - HTTP (Apache &lt;code>2.4.41&lt;/code>)&lt;/h3>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528112158.webp">&lt;/figure>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528114524.webp">&lt;/figure>
&lt;p>I couldn&amp;rsquo;t find nothing from these endpoints and the &lt;code>contact.php&lt;/code> is not even sending
any data.
After that I decided to start VHOST Enumeration using Ffuf:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>ffuf -u http://board.htb/ -H &lt;span style="color:#b8bb26">&amp;#39;Host: FUZZ.board.htb&amp;#39;&lt;/span> -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -fs &lt;span style="color:#d3869b">15949&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528120726.webp">&lt;/figure>
&lt;h3 id="crmboardcom---dolibarr-1700">crm.board.com - &lt;code>Dolibarr 17.0.0&lt;/code>&lt;/h3>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528120841.webp">&lt;/figure>
&lt;p>Found one valid domain that runs &lt;code>Dolibarr 17.0.0&lt;/code>&lt;/p>
&lt;h2 id="exploitation">Exploitation&lt;/h2>
&lt;h3 id="cve-2023-30253">&lt;code>CVE-2023-30253&lt;/code>&lt;/h3>
&lt;p>Found an exploit for Dolibarr 17.0.0: &lt;a href="https://github.com/nikn0laty/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253">https://github.com/nikn0laty/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253&lt;/a>
To run this exploit we need a working username and password. After some googling, found &lt;code>admin:admin&lt;/code> as the default
credentials. And it is working in the target.&lt;/p>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528122837.webp">&lt;/figure>
&lt;p>And we got the reverse shell.&lt;/p>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528122905.webp">&lt;/figure>
&lt;h2 id="lateral-movement-to-user">Lateral Movement to user&lt;/h2>
&lt;h3 id="local-enumeration">Local Enumeration&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>cat /etc/passwd | grep bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528124721.webp">&lt;/figure>
&lt;p>Found user &lt;code>larissa&lt;/code>&lt;/p>
&lt;p>Also inside the &lt;code>conf.php&lt;/code> file located in &lt;code>/html/crm.board.htb/htdocs/conf&lt;/code> found a password that can be used to SSH login as larissa into the system&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>cat conf.php | grep -v &lt;span style="color:#b8bb26">&amp;#39;^//&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528124918.webp">&lt;/figure>
&lt;h3 id="lateral-movement---ssh-larissa">Lateral Movement - SSH larissa&lt;/h3>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528125144.webp">&lt;/figure>
&lt;h2 id="privilege-escalation">Privilege Escalation&lt;/h2>
&lt;h3 id="local-enumeration-1">Local Enumeration&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>find / -perm -4000 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528141632.webp">&lt;/figure>
&lt;h3 id="privilege-escalation---cve-2022-37706">Privilege Escalation - &lt;code>CVE-2022-37706&lt;/code>&lt;/h3>
&lt;blockquote>
&lt;p>The Enlightenment Version: 0.25.3 is vulnerable to local privilege escalation.
Enlightenment_sys in Enlightenment before 0.25.3 allows local users to
gain privileges because it is setuid root,
and the system library function mishandles pathnames that begin with a
/dev/.. substring&lt;/p>
&lt;/blockquote>
&lt;p>After running this &lt;a href="https://www.exploit-db.com/exploits/51180">exploit&lt;/a>, we were able to
escalate privilege as root user.&lt;/p>
&lt;figure>
&lt;img src="https://h4r1337.github.io/img/boardlight/Pasted%20image%2020240528141745.webp">&lt;/figure>
&lt;p>Here is the &lt;a href="https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit">writeup&lt;/a> of
the exploit by the author.&lt;/p>
&lt;hr>
&lt;h4 id="resources">Resources&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://github.com/nikn0laty/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253">CVE-2023-30253&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.exploit-db.com/exploits/51180">CVE-2022-37706 Exploit&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit">CVE-2022-37706 Writeup&lt;/a>&lt;/li>
&lt;/ul></content></item></channel></rss>